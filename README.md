# 自動更新 QR Code 功能說明

## 🎯 功能概述

已移除 WebSocket 功能，改為實作**每2秒自動更新 QR Code**功能，QR Code 內容包含：
- 隨機 UUID
- 當前時間（台灣時區格式）

## 📁 需要更新的檔案

### 1. 替換 `app/routes/generate.tsx`
- 移除所有 WebSocket 相關程式碼
- 新增自動更新計時器功能
- 新增倒數計時顯示
- QR Code 內容格式：`UUID + "\n" + 時間`

### 2. 替換 `app/routes/scan.tsx`
- 移除 WebSocket 廣播功能
- 保持原有的掃描和資料庫儲存功能

### 3. 替換 `app/components/QrScanner.tsx`
- 移除 WebSocket 相關功能
- 保持原有的 QR 掃描功能
- 增強掃描結果顯示（支援多行內容格式化）

## ✨ 新功能特色

### 自動更新機制
- **間隔時間**：每2秒自動產生新的 QR Code
- **即時倒数**：顯示距離下次更新的秒數
- **手動控制**：可隨時暫停/啟動自動更新
- **立即產生**：提供手動立即產生按鈕

### QR Code 內容格式
```
ac7f2b3e-1d4a-4c8b-9e5f-123456789abc
2024/05/29 14:30:25
```

### 用戶介面改進
- **狀態指示器**：綠色閃爍表示自動更新進行中
- **倒數計時**：顯示"自動更新 (X秒後更新)"
- **暫停/啟動按鈕**：紅色暫停，綠色啟動
- **內容顯示**：分別顯示 UUID 和時間
- **系統日誌**：詳細的操作記錄

## 🚀 使用方式

### 啟動應用程式
```bash
npm run dev
```

### 使用流程
1. 前往 `/generate` 頁面
2. QR Code 會自動每2秒更新一次
3. 可以點擊「暫停」按鈕停止自動更新
4. 可以點擊「立即產生新的 QR Code」手動產生
5. 可以調整 QR Code 尺寸和容錯等級
6. 可以下載當前的 QR Code

### 掃描功能
1. 前往 `/scan` 頁面使用相機掃描
2. 掃描結果會格式化顯示（如果是多行內容）
3. 可以複製結果或儲存到資料庫

## 🔧 技術實作細節

### 客戶端計時器
- 使用 `setInterval` 每2秒觸發更新
- 使用 `useRef` 管理計時器引用
- 元件卸載時自動清理計時器

### 時間格式化
```typescript
const currentTime = new Date().toLocaleString('zh-TW', {
  timeZone: 'Asia/Taipei',
  year: 'numeric',
  month: '2-digit',
  day: '2-digit',
  hour: '2-digit',
  minute: '2-digit',
  second: '2-digit',
  hour12: false
});
```

### QR Code 產生
- 使用客戶端 `QRCode.toDataURL()` 方法
- 即時產生，無需伺服器請求
- 支援自訂尺寸和容錯等級

## 📱 用戶體驗

### 視覺回饋
- 自動更新狀態的綠色閃爍指示器
- 清楚的倒數計時顯示
- 直觀的暫停/啟動按鈕
- 格式化的內容顯示

### 效能優化
- 客戶端產生 QR Code，減少伺服器負載
- 計時器精確控制，避免重複請求
- 適當的元件清理，防止記憶體洩漏

## 🎨 設計特點

- **現代化 UI**：漸層背景和圓角設計
- **響應式布局**：適配不同螢幕尺寸
- **狀態指示**：清楚的視覺回饋
- **無縫體驗**：流暢的自動更新動畫

立即使用這個自動更新的 QR Code 產生器，享受每2秒自動刷新的便利功能！